<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quantum Atomic Model Visualizer | Chemistry Project</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --primary: #6366f1;
        --primary-dark: #4f46e5;
        --secondary: #8b5cf6;
        --accent: #06b6d4;
        --accent-bright: #22d3ee;
        --bg-dark: #0a0e27;
        --bg-darker: #050816;
        --bg-card: rgba(30, 41, 59, 0.4);
        --bg-glass: rgba(255, 255, 255, 0.05);
        --text-primary: #ffffff;
        --text-secondary: #cbd5e1;
        --text-muted: #94a3b8;
        --border: rgba(255, 255, 255, 0.1);
        --border-bright: rgba(99, 102, 241, 0.3);
        --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
        --shadow-md: 0 4px 20px rgba(0, 0, 0, 0.2);
        --shadow-lg: 0 8px 40px rgba(0, 0, 0, 0.3);
        --shadow-glow: 0 0 30px rgba(99, 102, 241, 0.4);
        --shadow-glow-strong: 0 0 50px rgba(99, 102, 241, 0.6);
      }

      body {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        background: var(--bg-darker);
        color: var(--text-primary);
        min-height: 100vh;
        overflow-x: hidden;
        position: relative;
        font-weight: 400;
        letter-spacing: -0.01em;
      }

      /* Animated background gradient */
      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(
            circle at 20% 30%,
            rgba(99, 102, 241, 0.15) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 70%,
            rgba(139, 92, 246, 0.15) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 50% 50%,
            rgba(6, 182, 212, 0.1) 0%,
            transparent 70%
          );
        pointer-events: none;
        z-index: 0;
        animation: gradientShift 20s ease infinite;
      }

      @keyframes gradientShift {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.8;
          transform: scale(1.1);
        }
      }

      .container {
        max-width: 1800px;
        margin: 0 auto;
        padding: 30px;
        position: relative;
        z-index: 1;
      }

      /* Premium Header */
      .header {
        text-align: center;
        margin-bottom: 50px;
        padding: 45px 30px;
        background: linear-gradient(
          135deg,
          rgba(99, 102, 241, 0.18) 0%,
          rgba(139, 92, 246, 0.18) 50%,
          rgba(6, 182, 212, 0.15) 100%
        );
        backdrop-filter: blur(40px) saturate(180%);
        -webkit-backdrop-filter: blur(40px) saturate(180%);
        border-radius: 32px;
        border: 1px solid rgba(255, 255, 255, 0.18);
        box-shadow: 0 8px 32px rgba(99, 102, 241, 0.35),
          0 0 80px rgba(139, 92, 246, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.2),
          inset 0 -1px 0 rgba(0, 0, 0, 0.1);
        position: relative;
        overflow: hidden;
        transform-style: preserve-3d;
        transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
      }

      .header:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 48px rgba(99, 102, 241, 0.5),
          0 0 120px rgba(139, 92, 246, 0.3),
          inset 0 1px 0 rgba(255, 255, 255, 0.3);
        border-color: rgba(255, 255, 255, 0.3);
      }

      .header::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 200%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.15),
          transparent
        );
        animation: shimmer 3s infinite;
      }

      .header::after {
        content: "";
        position: absolute;
        inset: -2px;
        border-radius: 32px;
        padding: 2px;
        background: linear-gradient(
          135deg,
          rgba(99, 102, 241, 0.5),
          rgba(139, 92, 246, 0.5),
          rgba(6, 182, 212, 0.5)
        );
        -webkit-mask: linear-gradient(#fff 0 0) content-box,
          linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask-composite: exclude;
        opacity: 0;
        transition: opacity 0.6s ease;
        pointer-events: none;
      }

      .header:hover::after {
        opacity: 1;
      }

      @keyframes shimmer {
        0% {
          left: -100%;
        }
        100% {
          left: 200%;
        }
      }
      .header h1 {
        font-size: 42px;
        font-weight: 800;
        margin-bottom: 8px;
        background: linear-gradient(135deg, #ffffff 0%, #cbd5e1 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        letter-spacing: -0.02em;
        position: relative;
        z-index: 1;
      }

      .header p {
        font-size: 16px;
        color: var(--text-secondary);
        font-weight: 400;
        position: relative;
        z-index: 1;
      }

      /* Premium Controls */
      .controls {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 14px;
        flex-wrap: wrap;
        padding: 24px 32px;
        background: var(--bg-glass);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        border-radius: 20px;
        margin-bottom: 30px;
        border: 1px solid var(--border);
        box-shadow: var(--shadow-lg), inset 0 1px 0 rgba(255, 255, 255, 0.1);
      }

      .btn {
        padding: 14px 26px;
        font-size: 15px;
        font-weight: 600;
        background: linear-gradient(
          135deg,
          var(--primary) 0%,
          var(--primary-dark) 100%
        );
        color: white;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4),
          inset 0 1px 0 rgba(255, 255, 255, 0.2);
        position: relative;
        overflow: hidden;
        letter-spacing: 0.01em;
        font-family: "Inter", sans-serif;
      }

      .btn::before {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.3);
        transform: translate(-50%, -50%);
        transition: width 0.6s, height 0.6s;
      }

      .btn:hover:not(:disabled)::before {
        width: 300px;
        height: 300px;
      }

      .btn:hover:not(:disabled) {
        transform: translateY(-2px) scale(1.02);
        box-shadow: 0 8px 25px rgba(99, 102, 241, 0.6),
          inset 0 1px 0 rgba(255, 255, 255, 0.3);
      }

      .btn:active:not(:disabled) {
        transform: translateY(0) scale(0.98);
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        box-shadow: none;
      }

      .btn-secondary {
        background: linear-gradient(
          135deg,
          rgba(139, 92, 246, 0.2) 0%,
          rgba(99, 102, 241, 0.2) 100%
        );
        border: 1px solid var(--border-bright);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .btn-secondary:hover:not(:disabled) {
        background: linear-gradient(
          135deg,
          rgba(139, 92, 246, 0.3) 0%,
          rgba(99, 102, 241, 0.3) 100%
        );
        box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
      }

      select {
        padding: 14px 24px;
        font-size: 15px;
        font-weight: 500;
        background: rgba(0, 0, 0, 0.4);
        color: white;
        border: 1px solid var(--border);
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23ffffff' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 16px center;
        padding-right: 48px;
        box-shadow: var(--shadow-sm);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }

      select:hover {
        border-color: var(--border-bright);
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
      }

      select:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.2);
      }

      /* Main content layout */
      .main-content {
        display: flex;
        gap: 30px;
        align-items: flex-start;
      }

      /* Visualization section */
      .visualization-section {
        flex: 1.3;
        min-width: 0;
      }

      .visualization-container {
        position: relative;
        width: 100%;
        height: 750px;
        display: flex;
        justify-content: center;
        align-items: center;
        background: radial-gradient(
          ellipse at center,
          rgba(99, 102, 241, 0.08) 0%,
          transparent 70%
        );
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-radius: 24px;
        overflow: hidden;
        border: 1px solid var(--border);
        box-shadow: var(--shadow-lg), var(--shadow-glow);
        margin-bottom: 20px;
        transition: box-shadow 0.3s ease;
      }

      .visualization-container:hover {
        box-shadow: var(--shadow-lg), var(--shadow-glow-strong);
      }

      canvas {
        display: block;
        filter: drop-shadow(0 0 20px rgba(99, 102, 241, 0.3));
      }

      /* Premium Legend */
      .legend {
        display: flex;
        justify-content: center;
        gap: 24px;
        flex-wrap: wrap;
        padding: 20px 24px;
        background: var(--bg-glass);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        border-radius: 16px;
        border: 1px solid var(--border);
        box-shadow: var(--shadow-md);
        font-size: 14px;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 10px;
        color: var(--text-secondary);
        padding: 6px 12px;
        border-radius: 8px;
        transition: all 0.2s ease;
      }

      .legend-item:hover {
        background: rgba(255, 255, 255, 0.05);
        color: var(--text-primary);
      }

      .legend-color {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        box-shadow: 0 0 10px currentColor;
        transition: transform 0.2s ease;
      }

      .legend-item:hover .legend-color {
        transform: scale(1.2);
      }

      /* Premium Info Panel */
      .info-section {
        flex: 0.9;
        min-width: 350px;
      }

      .info-panel {
        padding: 40px;
        background: var(--bg-glass);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        border-radius: 24px;
        border: 1px solid var(--border);
        box-shadow: var(--shadow-lg), inset 0 1px 0 rgba(255, 255, 255, 0.1);
        margin-bottom: 20px;
        position: relative;
        overflow: hidden;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .info-panel::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 2px;
        background: linear-gradient(
          90deg,
          var(--primary),
          var(--secondary),
          var(--accent)
        );
        opacity: 0.6;
      }

      .info-panel:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg), 0 0 40px rgba(99, 102, 241, 0.2);
      }

      .element-name {
        font-size: 56px;
        font-weight: 800;
        margin: 20px 0;
        background: linear-gradient(
          135deg,
          var(--accent-bright) 0%,
          var(--accent) 50%,
          var(--primary) 100%
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        letter-spacing: -0.03em;
        text-align: center;
      }

      .element-info {
        font-size: 19px;
        margin: 12px 0;
        color: var(--text-secondary);
        font-weight: 500;
        text-align: center;
        letter-spacing: 0.01em;
      }

      .electron-config {
        font-size: 22px;
        font-family: "JetBrains Mono", monospace;
        color: #10b981;
        margin-top: 30px;
        padding: 18px 24px;
        background: linear-gradient(
          135deg,
          rgba(16, 185, 129, 0.15) 0%,
          rgba(5, 150, 105, 0.15) 100%
        );
        border-radius: 16px;
        display: block;
        border: 1px solid rgba(16, 185, 129, 0.3);
        font-weight: 600;
        text-align: center;
        box-shadow: 0 4px 15px rgba(16, 185, 129, 0.2);
        letter-spacing: 0.05em;
      }

      .mass-number {
        font-size: 22px;
        color: var(--accent-bright);
        margin-top: 25px;
        font-weight: 700;
        text-align: center;
        letter-spacing: 0.02em;
      }

      .isotope-controls {
        display: flex;
        justify-content: center;
        gap: 12px;
        margin-top: 20px;
      }

      .isotope-controls .btn {
        padding: 12px 22px;
        font-size: 14px;
      }

      /* Responsive */
      @media (max-width: 1200px) {
        .main-content {
          flex-direction: column;
        }

        .visualization-section,
        .info-section {
          flex: 1;
          width: 100%;
        }

        .visualization-container {
          height: 600px;
        }

        .element-name {
          font-size: 48px;
        }
      }

      @media (max-width: 768px) {
        .header h1 {
          font-size: 32px;
        }

        .controls {
          padding: 20px;
          gap: 10px;
        }

        .btn {
          padding: 12px 20px;
          font-size: 14px;
        }

        .element-name {
          font-size: 40px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>Quantum Atomic Model Visualizer</h1>
        <p>
          Chemically Accurate Atomic Structure with s, p, and d Orbitals (Z=1 to
          Z=20)
        </p>
      </div>

      <div class="controls">
        <button id="prevBtn" class="btn">← Previous</button>
        <button id="nextBtn" class="btn">Next →</button>
        <select id="elementSelect"></select>
        <button id="playEvolutionBtn" class="btn btn-secondary">
          ▶ Play Evolution
        </button>
        <div class="isotope-controls">
          <button id="addNeutronBtn" class="btn btn-secondary">
            + Neutron
          </button>
          <button id="removeNeutronBtn" class="btn btn-secondary">
            − Neutron
          </button>
        </div>
      </div>

      <div class="main-content">
        <!-- Left: Visualization -->
        <div class="visualization-section">
          <div class="visualization-container">
            <canvas id="atomCanvas" width="1000" height="750"></canvas>
          </div>

          <div class="legend">
            <div class="legend-item">
              <div
                class="legend-color"
                style="background: #ef4444; color: #ef4444"
              ></div>
              <span>Protons</span>
            </div>
            <div class="legend-item">
              <div
                class="legend-color"
                style="background: #3b82f6; color: #3b82f6"
              ></div>
              <span>Neutrons</span>
            </div>
            <div class="legend-item">
              <div
                class="legend-color"
                style="background: #06b6d4; color: #06b6d4"
              ></div>
              <span>s-orbital</span>
            </div>
            <div class="legend-item">
              <div
                class="legend-color"
                style="background: #8b5cf6; color: #8b5cf6"
              ></div>
              <span>p-orbital</span>
            </div>
            <div class="legend-item">
              <div
                class="legend-color"
                style="background: #f59e0b; color: #f59e0b"
              ></div>
              <span>d-orbital</span>
            </div>
          </div>
        </div>

        <!-- Right: Information -->
        <div class="info-section">
          <div class="info-panel">
            <div class="element-name" id="elementName">Hydrogen</div>
            <div class="element-info" id="elementInfo">
              Atomic Number: 1 | Symbol: H
            </div>
            <div class="electron-config" id="electronConfig">1s¹</div>
            <div class="mass-number" id="massNumber">Mass Number: 1</div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Accurate electron configurations with orbital occupancy
      const ELEMENTS = [
        {
          atomicNumber: 1,
          symbol: "H",
          name: "Hydrogen",
          defaultNeutrons: 0,
          electronConfig: "1s¹",
          orbitals: {
            "1s": 1,
            "2s": 0,
            "2px": 0,
            "2py": 0,
            "2pz": 0,
            "3s": 0,
            "3px": 0,
            "3py": 0,
            "3pz": 0,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 2,
          symbol: "He",
          name: "Helium",
          defaultNeutrons: 2,
          electronConfig: "1s²",
          orbitals: {
            "1s": 2,
            "2s": 0,
            "2px": 0,
            "2py": 0,
            "2pz": 0,
            "3s": 0,
            "3px": 0,
            "3py": 0,
            "3pz": 0,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 3,
          symbol: "Li",
          name: "Lithium",
          defaultNeutrons: 4,
          electronConfig: "1s² 2s¹",
          orbitals: {
            "1s": 2,
            "2s": 1,
            "2px": 0,
            "2py": 0,
            "2pz": 0,
            "3s": 0,
            "3px": 0,
            "3py": 0,
            "3pz": 0,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 4,
          symbol: "Be",
          name: "Beryllium",
          defaultNeutrons: 5,
          electronConfig: "1s² 2s²",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 0,
            "2py": 0,
            "2pz": 0,
            "3s": 0,
            "3px": 0,
            "3py": 0,
            "3pz": 0,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 5,
          symbol: "B",
          name: "Boron",
          defaultNeutrons: 6,
          electronConfig: "1s² 2s² 2p¹",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 1,
            "2py": 0,
            "2pz": 0,
            "3s": 0,
            "3px": 0,
            "3py": 0,
            "3pz": 0,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 6,
          symbol: "C",
          name: "Carbon",
          defaultNeutrons: 6,
          electronConfig: "1s² 2s² 2p²",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 1,
            "2py": 1,
            "2pz": 0,
            "3s": 0,
            "3px": 0,
            "3py": 0,
            "3pz": 0,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 7,
          symbol: "N",
          name: "Nitrogen",
          defaultNeutrons: 7,
          electronConfig: "1s² 2s² 2p³",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 1,
            "2py": 1,
            "2pz": 1,
            "3s": 0,
            "3px": 0,
            "3py": 0,
            "3pz": 0,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 8,
          symbol: "O",
          name: "Oxygen",
          defaultNeutrons: 8,
          electronConfig: "1s² 2s² 2p⁴",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 2,
            "2py": 1,
            "2pz": 1,
            "3s": 0,
            "3px": 0,
            "3py": 0,
            "3pz": 0,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 9,
          symbol: "F",
          name: "Fluorine",
          defaultNeutrons: 10,
          electronConfig: "1s² 2s² 2p⁵",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 2,
            "2py": 2,
            "2pz": 1,
            "3s": 0,
            "3px": 0,
            "3py": 0,
            "3pz": 0,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 10,
          symbol: "Ne",
          name: "Neon",
          defaultNeutrons: 10,
          electronConfig: "1s² 2s² 2p⁶",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 2,
            "2py": 2,
            "2pz": 2,
            "3s": 0,
            "3px": 0,
            "3py": 0,
            "3pz": 0,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 11,
          symbol: "Na",
          name: "Sodium",
          defaultNeutrons: 12,
          electronConfig: "1s² 2s² 2p⁶ 3s¹",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 2,
            "2py": 2,
            "2pz": 2,
            "3s": 1,
            "3px": 0,
            "3py": 0,
            "3pz": 0,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 12,
          symbol: "Mg",
          name: "Magnesium",
          defaultNeutrons: 12,
          electronConfig: "1s² 2s² 2p⁶ 3s²",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 2,
            "2py": 2,
            "2pz": 2,
            "3s": 2,
            "3px": 0,
            "3py": 0,
            "3pz": 0,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 13,
          symbol: "Al",
          name: "Aluminum",
          defaultNeutrons: 14,
          electronConfig: "1s² 2s² 2p⁶ 3s² 3p¹",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 2,
            "2py": 2,
            "2pz": 2,
            "3s": 2,
            "3px": 1,
            "3py": 0,
            "3pz": 0,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 14,
          symbol: "Si",
          name: "Silicon",
          defaultNeutrons: 14,
          electronConfig: "1s² 2s² 2p⁶ 3s² 3p²",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 2,
            "2py": 2,
            "2pz": 2,
            "3s": 2,
            "3px": 1,
            "3py": 1,
            "3pz": 0,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 15,
          symbol: "P",
          name: "Phosphorus",
          defaultNeutrons: 16,
          electronConfig: "1s² 2s² 2p⁶ 3s² 3p³",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 2,
            "2py": 2,
            "2pz": 2,
            "3s": 2,
            "3px": 1,
            "3py": 1,
            "3pz": 1,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 16,
          symbol: "S",
          name: "Sulfur",
          defaultNeutrons: 16,
          electronConfig: "1s² 2s² 2p⁶ 3s² 3p⁴",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 2,
            "2py": 2,
            "2pz": 2,
            "3s": 2,
            "3px": 2,
            "3py": 1,
            "3pz": 1,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 17,
          symbol: "Cl",
          name: "Chlorine",
          defaultNeutrons: 18,
          electronConfig: "1s² 2s² 2p⁶ 3s² 3p⁵",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 2,
            "2py": 2,
            "2pz": 2,
            "3s": 2,
            "3px": 2,
            "3py": 2,
            "3pz": 1,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 18,
          symbol: "Ar",
          name: "Argon",
          defaultNeutrons: 22,
          electronConfig: "1s² 2s² 2p⁶ 3s² 3p⁶",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 2,
            "2py": 2,
            "2pz": 2,
            "3s": 2,
            "3px": 2,
            "3py": 2,
            "3pz": 2,
            "4s": 0,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 19,
          symbol: "K",
          name: "Potassium",
          defaultNeutrons: 20,
          electronConfig: "1s² 2s² 2p⁶ 3s² 3p⁶ 4s¹",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 2,
            "2py": 2,
            "2pz": 2,
            "3s": 2,
            "3px": 2,
            "3py": 2,
            "3pz": 2,
            "4s": 1,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
        {
          atomicNumber: 20,
          symbol: "Ca",
          name: "Calcium",
          defaultNeutrons: 20,
          electronConfig: "1s² 2s² 2p⁶ 3s² 3p⁶ 4s²",
          orbitals: {
            "1s": 2,
            "2s": 2,
            "2px": 2,
            "2py": 2,
            "2pz": 2,
            "3s": 2,
            "3px": 2,
            "3py": 2,
            "3pz": 2,
            "4s": 2,
            "3dxy": 0,
            "3dxz": 0,
            "3dyz": 0,
            "3dx²-y²": 0,
            "3dz²": 0,
          },
        },
      ];

      // Application state
      let currentElementIndex = 0;
      let currentNeutrons = 0;
      let animationFrame = null;
      let time = 0;
      let isEvolutionPlaying = false;
      let evolutionInterval = null;

      // Canvas setup
      const canvas = document.getElementById("atomCanvas");
      const ctx = canvas.getContext("2d");

      // Quantum-accurate orbital radii
      const ORBITAL_RADIUS = {
        "1s": 70,
        "2s": 140,
        "2p": 140,
        "3s": 210,
        "3p": 210,
        "3d": 210,
        "4s": 280,
      };

      // Colors
      const COLORS = {
        s: "#06b6d4",
        p: "#8b5cf6",
        d: "#f59e0b",
        electron: "#ffffff",
        proton: "#ef4444",
        neutron: "#3b82f6",
      };

      function init() {
        resizeCanvas();
        window.addEventListener("resize", resizeCanvas);

        currentNeutrons = ELEMENTS[currentElementIndex].defaultNeutrons;
        populateElementSelect();
        updateUI();
        animate();

        document
          .getElementById("prevBtn")
          .addEventListener("click", () => changeElement(-1));
        document
          .getElementById("nextBtn")
          .addEventListener("click", () => changeElement(1));
        document
          .getElementById("elementSelect")
          .addEventListener("change", (e) => {
            currentElementIndex = parseInt(e.target.value);
            currentNeutrons = ELEMENTS[currentElementIndex].defaultNeutrons;
            updateUI();
          });
        document
          .getElementById("addNeutronBtn")
          .addEventListener("click", () => modifyNeutrons(1));
        document
          .getElementById("removeNeutronBtn")
          .addEventListener("click", () => modifyNeutrons(-1));
        document
          .getElementById("playEvolutionBtn")
          .addEventListener("click", toggleEvolution);
      }

      function resizeCanvas() {
        const container = canvas.parentElement;
        const rect = container.getBoundingClientRect();
        canvas.width = rect.width;
        canvas.height = rect.height;
      }

      function populateElementSelect() {
        const select = document.getElementById("elementSelect");
        select.innerHTML = "";
        ELEMENTS.forEach((element, index) => {
          const option = document.createElement("option");
          option.value = index;
          option.textContent = `${element.symbol} - ${element.name}`;
          if (index === currentElementIndex) option.selected = true;
          select.appendChild(option);
        });
      }

      function changeElement(delta) {
        currentElementIndex += delta;
        if (currentElementIndex < 0) currentElementIndex = ELEMENTS.length - 1;
        if (currentElementIndex >= ELEMENTS.length) currentElementIndex = 0;
        currentNeutrons = ELEMENTS[currentElementIndex].defaultNeutrons;
        updateUI();
        populateElementSelect();
      }

      function modifyNeutrons(delta) {
        const newNeutrons = currentNeutrons + delta;
        if (newNeutrons >= 0) {
          currentNeutrons = newNeutrons;
          updateUI();
        }
      }

      function updateUI() {
        const element = ELEMENTS[currentElementIndex];
        document.getElementById("elementName").textContent = element.name;
        document.getElementById(
          "elementInfo"
        ).textContent = `Atomic Number: ${element.atomicNumber} | Symbol: ${element.symbol}`;
        document.getElementById("electronConfig").textContent =
          element.electronConfig;
        document.getElementById("massNumber").textContent = `Mass Number: ${
          element.atomicNumber + currentNeutrons
        }`;

        document.getElementById("prevBtn").disabled =
          currentElementIndex === 0 && !isEvolutionPlaying;
        document.getElementById("nextBtn").disabled =
          currentElementIndex === ELEMENTS.length - 1 && !isEvolutionPlaying;
        document.getElementById("removeNeutronBtn").disabled =
          currentNeutrons === 0;
      }

      function toggleEvolution() {
        if (isEvolutionPlaying) {
          stopEvolution();
        } else {
          startEvolution();
        }
      }

      function startEvolution() {
        isEvolutionPlaying = true;
        document.getElementById("playEvolutionBtn").textContent =
          "⏸ Stop Evolution";
        document.getElementById("elementSelect").disabled = true;

        let index = 0;
        evolutionInterval = setInterval(() => {
          currentElementIndex = index;
          currentNeutrons = ELEMENTS[currentElementIndex].defaultNeutrons;
          updateUI();
          populateElementSelect();

          index++;
          if (index >= ELEMENTS.length) {
            stopEvolution();
          }
        }, 2000);
      }

      function stopEvolution() {
        isEvolutionPlaying = false;
        if (evolutionInterval) {
          clearInterval(evolutionInterval);
          evolutionInterval = null;
        }
        document.getElementById("playEvolutionBtn").textContent =
          "▶ Play Evolution";
        document.getElementById("elementSelect").disabled = false;
      }

      // Get electron position on s-orbital
      function getSElectronPosition(radius, electronIndex, totalElectrons, t) {
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;

        const spinOffset = electronIndex % 2 === 0 ? 0 : Math.PI;
        const phaseOffset =
          Math.floor(electronIndex / 2) *
          ((2 * Math.PI) / Math.max(Math.ceil(totalElectrons / 2), 1));

        // Smoother, slower animation
        const angle = t * 0.3 + phaseOffset + spinOffset;

        const x = centerX + Math.cos(angle) * radius;
        const y = centerY + Math.sin(angle) * radius;

        return { x, y, spin: electronIndex % 2 === 0 ? 1 : -1 };
      }

      // Get electron position on p-orbital - smooth movement
      // Get electron position on p-orbital - FIXED: smooth tracing of elliptical lobes
      function getPElectronPosition(
        radius,
        orientation,
        electronIndex,
        totalElectrons,
        t
      ) {
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;

        const lobeSize = radius * 0.4;
        const nodeDistance = radius * 0.65;

        // Smooth phase offset
        const phaseOffset = electronIndex * 0.4;
        const spinOffset = electronIndex % 2 === 0 ? 0 : Math.PI;

        // Slower, smoother parameter for infinity symbol
        let param = t * 0.35 + phaseOffset + spinOffset;

        // Normalize efficiently
        param = param % (Math.PI * 2);
        if (param < 0) param += Math.PI * 2;

        let x, y;

        if (orientation === "x") {
          const denom = 1 + Math.sin(param) * Math.sin(param);
          x = centerX + (nodeDistance * Math.cos(param)) / denom;
          y = centerY + (lobeSize * Math.sin(param) * Math.cos(param)) / denom;
        } else if (orientation === "y") {
          const denom = 1 + Math.sin(param) * Math.sin(param);
          x = centerX + (lobeSize * Math.sin(param) * Math.cos(param)) / denom;
          y = centerY + (nodeDistance * Math.cos(param)) / denom;
        } else {
          const denom = 1 + Math.sin(param) * Math.sin(param);
          const infX = (nodeDistance * Math.cos(param)) / denom;
          const infY = (lobeSize * Math.sin(param) * Math.cos(param)) / denom;

          const angle45 = Math.PI / 4;
          const cos45 = Math.cos(angle45);
          const sin45 = Math.sin(angle45);
          x = centerX + infX * cos45 - infY * sin45;
          y = centerY + infX * sin45 + infY * cos45;
        }

        return { x, y, spin: electronIndex % 2 === 0 ? 1 : -1 };
      }

      // Get electron position on d-orbital
      function getDElectronPosition(
        radius,
        type,
        electronIndex,
        totalElectrons,
        t
      ) {
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;

        const lobeSize = radius * 0.35;
        const lobeDistance = radius * 0.7;
        const phaseOffset = electronIndex * 0.25;
        const spinOffset = electronIndex % 2 === 0 ? 0 : Math.PI;

        let x, y;

        if (type === "dxy" || type === "dxz" || type === "dyz") {
          const baseAngle =
            type === "dxy" ? Math.PI / 4 : type === "dxz" ? 0 : Math.PI / 4;

          // Smoother angle calculation
          let angle = (t * 0.3 + phaseOffset + spinOffset) % (Math.PI * 2);
          if (angle < 0) angle += Math.PI * 2;

          const lobeAngles = [
            baseAngle,
            baseAngle + Math.PI / 2,
            baseAngle + Math.PI,
            baseAngle + (3 * Math.PI) / 2,
          ];

          const nearestLobe = lobeAngles.reduce((prev, curr) => {
            const prevDiff = Math.abs(angle - prev) % (Math.PI * 2);
            const currDiff = Math.abs(angle - curr) % (Math.PI * 2);
            return prevDiff < currDiff ? prev : curr;
          });

          const distance = lobeDistance * (0.8 + 0.2 * Math.sin(angle * 2));
          x = centerX + distance * Math.cos(nearestLobe);
          y = centerY + distance * Math.sin(nearestLobe);
        } else if (type === "dx²-y²") {
          let angle = (t * 0.3 + phaseOffset + spinOffset) % (Math.PI * 2);
          if (angle < 0) angle += Math.PI * 2;

          const lobeAngles = [0, Math.PI / 2, Math.PI, (3 * Math.PI) / 2];

          const nearestLobe = lobeAngles.reduce((prev, curr) => {
            const prevDiff = Math.abs(angle - prev) % (Math.PI * 2);
            const currDiff = Math.abs(angle - curr) % (Math.PI * 2);
            return prevDiff < currDiff ? prev : curr;
          });

          const distance = lobeDistance * (0.8 + 0.2 * Math.sin(angle * 2));
          x = centerX + distance * Math.cos(nearestLobe);
          y = centerY + distance * Math.sin(nearestLobe);
        } else if (type === "dz²") {
          let angle = (t * 0.3 + phaseOffset + spinOffset) % (Math.PI * 2);
          if (angle < 0) angle += Math.PI * 2;

          const donutRadius = lobeDistance * 0.5;
          x = centerX + donutRadius * Math.cos(angle);
          y = centerY + donutRadius * Math.sin(angle);
        }

        return { x, y, spin: electronIndex % 2 === 0 ? 1 : -1 };
      }

      // Render functions (keeping the same as before)
      function renderSOrbital(radius, color) {
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;

        ctx.save();
        ctx.strokeStyle = color;
        ctx.globalAlpha = 0.3;
        ctx.lineWidth = 2.5;

        ctx.beginPath();
        ctx.arc(centerX, centerY, radius, 0, Math.PI * 2);
        ctx.stroke();

        ctx.globalAlpha = 0.15;
        ctx.beginPath();
        ctx.arc(centerX, centerY, radius * 0.65, 0, Math.PI * 2);
        ctx.stroke();

        ctx.restore();
      }

      function renderPOrbital(radius, orientation, color) {
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;

        ctx.save();
        ctx.strokeStyle = color;
        ctx.globalAlpha = 0.35;
        ctx.lineWidth = 2.5;

        const lobeSize = radius * 0.4;
        const nodeDistance = radius * 0.65;

        // Draw infinity symbol using parametric equations
        ctx.beginPath();

        if (orientation === "x") {
          // Horizontal infinity (∞) for px
          for (let t = 0; t <= Math.PI * 2; t += 0.1) {
            // Parametric equation for lemniscate (infinity symbol)
            const denom = 1 + Math.sin(t) * Math.sin(t);
            const x = centerX + (nodeDistance * Math.cos(t)) / denom;
            const y = centerY + (lobeSize * Math.sin(t) * Math.cos(t)) / denom;

            if (t === 0) {
              ctx.moveTo(x, y);
            } else {
              ctx.lineTo(x, y);
            }
          }
          ctx.closePath();
          ctx.stroke();
        } else if (orientation === "y") {
          // Vertical infinity (∞ rotated 90°) for py
          for (let t = 0; t <= Math.PI * 2; t += 0.1) {
            const denom = 1 + Math.sin(t) * Math.sin(t);
            const x = centerX + (lobeSize * Math.sin(t) * Math.cos(t)) / denom;
            const y = centerY + (nodeDistance * Math.cos(t)) / denom;

            if (t === 0) {
              ctx.moveTo(x, y);
            } else {
              ctx.lineTo(x, y);
            }
          }
          ctx.closePath();
          ctx.stroke();
        } else {
          // Diagonal infinity (pz) - rotated 45 degrees
          for (let t = 0; t <= Math.PI * 2; t += 0.1) {
            const denom = 1 + Math.sin(t) * Math.sin(t);
            const infX = (nodeDistance * Math.cos(t)) / denom;
            const infY = (lobeSize * Math.sin(t) * Math.cos(t)) / denom;

            // Rotate 45 degrees
            const angle45 = Math.PI / 4;
            const cos45 = Math.cos(angle45);
            const sin45 = Math.sin(angle45);
            const x = centerX + infX * cos45 - infY * sin45;
            const y = centerY + infX * sin45 + infY * cos45;

            if (t === 0) {
              ctx.moveTo(x, y);
            } else {
              ctx.lineTo(x, y);
            }
          }
          ctx.closePath();
          ctx.stroke();
        }

        ctx.restore();
      }

      function renderDOrbital(radius, type, color) {
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;

        ctx.save();
        ctx.strokeStyle = color;
        ctx.globalAlpha = 0.35;
        ctx.lineWidth = 2.5;

        const lobeSize = radius * 0.35;
        const lobeDistance = radius * 0.7;

        if (type === "dxy" || type === "dxz" || type === "dyz") {
          const angles =
            type === "dxy"
              ? [
                  Math.PI / 4,
                  (3 * Math.PI) / 4,
                  (5 * Math.PI) / 4,
                  (7 * Math.PI) / 4,
                ]
              : type === "dxz"
              ? [0, Math.PI / 2, Math.PI, (3 * Math.PI) / 2]
              : [
                  Math.PI / 4,
                  (3 * Math.PI) / 4,
                  (5 * Math.PI) / 4,
                  (7 * Math.PI) / 4,
                ];

          angles.forEach((angle) => {
            const x = centerX + lobeDistance * Math.cos(angle);
            const y = centerY + lobeDistance * Math.sin(angle);
            ctx.beginPath();
            ctx.ellipse(x, y, lobeSize, lobeSize * 0.5, angle, 0, Math.PI * 2);
            ctx.stroke();
          });
        } else if (type === "dx²-y²") {
          const angles = [0, Math.PI / 2, Math.PI, (3 * Math.PI) / 2];
          angles.forEach((angle) => {
            const x = centerX + lobeDistance * Math.cos(angle);
            const y = centerY + lobeDistance * Math.sin(angle);
            ctx.beginPath();
            ctx.ellipse(x, y, lobeSize, lobeSize * 0.5, angle, 0, Math.PI * 2);
            ctx.stroke();
          });
        } else if (type === "dz²") {
          ctx.globalAlpha = 0.25;
          ctx.beginPath();
          ctx.arc(centerX, centerY, lobeDistance * 0.5, 0, Math.PI * 2);
          ctx.stroke();

          ctx.globalAlpha = 0.35;
          ctx.beginPath();
          ctx.ellipse(
            centerX,
            centerY - lobeDistance * 0.7,
            lobeSize * 0.5,
            lobeSize,
            0,
            0,
            Math.PI * 2
          );
          ctx.stroke();
          ctx.beginPath();
          ctx.ellipse(
            centerX,
            centerY + lobeDistance * 0.7,
            lobeSize * 0.5,
            lobeSize,
            0,
            0,
            Math.PI * 2
          );
          ctx.stroke();
        }

        ctx.restore();
      }

      function renderElectrons() {
        const element = ELEMENTS[currentElementIndex];

        ctx.save();

        ["1s", "2s", "3s", "4s"].forEach((orbital) => {
          const count = element.orbitals[orbital] || 0;
          if (count > 0) {
            const radius = ORBITAL_RADIUS[orbital];
            for (let i = 0; i < count; i++) {
              const pos = getSElectronPosition(radius, i, count, time);

              ctx.fillStyle = COLORS.electron;
              ctx.globalAlpha = 0.95;
              ctx.shadowBlur = 20;
              ctx.shadowColor = COLORS.s;

              ctx.beginPath();
              ctx.arc(pos.x, pos.y, 6, 0, Math.PI * 2);
              ctx.fill();

              ctx.strokeStyle = pos.spin > 0 ? "#10b981" : "#f59e0b";
              ctx.lineWidth = 2;
              ctx.globalAlpha = 0.9;
              ctx.beginPath();
              ctx.moveTo(pos.x - 4, pos.y - 4);
              ctx.lineTo(pos.x + 4, pos.y - 4);
              if (pos.spin > 0) {
                ctx.lineTo(pos.x + 2, pos.y - 6);
              } else {
                ctx.lineTo(pos.x - 2, pos.y - 6);
              }
              ctx.stroke();
            }
          }
        });

        [
          { name: "2px", radius: ORBITAL_RADIUS["2p"], orient: "x" },
          { name: "2py", radius: ORBITAL_RADIUS["2p"], orient: "y" },
          { name: "2pz", radius: ORBITAL_RADIUS["2p"], orient: "z" },
          { name: "3px", radius: ORBITAL_RADIUS["3p"], orient: "x" },
          { name: "3py", radius: ORBITAL_RADIUS["3p"], orient: "y" },
          { name: "3pz", radius: ORBITAL_RADIUS["3p"], orient: "z" },
        ].forEach(({ name, radius, orient }) => {
          const count = element.orbitals[name] || 0;
          if (count > 0) {
            for (let i = 0; i < count; i++) {
              const pos = getPElectronPosition(radius, orient, i, count, time);

              ctx.fillStyle = COLORS.electron;
              ctx.globalAlpha = 0.95;
              ctx.shadowBlur = 20;
              ctx.shadowColor = COLORS.p;

              ctx.beginPath();
              ctx.arc(pos.x, pos.y, 6, 0, Math.PI * 2);
              ctx.fill();

              ctx.strokeStyle = pos.spin > 0 ? "#10b981" : "#f59e0b";
              ctx.lineWidth = 2;
              ctx.globalAlpha = 0.9;
              ctx.beginPath();
              ctx.moveTo(pos.x - 4, pos.y - 4);
              ctx.lineTo(pos.x + 4, pos.y - 4);
              if (pos.spin > 0) {
                ctx.lineTo(pos.x + 2, pos.y - 6);
              } else {
                ctx.lineTo(pos.x - 2, pos.y - 6);
              }
              ctx.stroke();
            }
          }
        });

        [
          { name: "3dxy", radius: ORBITAL_RADIUS["3d"], type: "dxy" },
          { name: "3dxz", radius: ORBITAL_RADIUS["3d"], type: "dxz" },
          { name: "3dyz", radius: ORBITAL_RADIUS["3d"], type: "dyz" },
          { name: "3dx²-y²", radius: ORBITAL_RADIUS["3d"], type: "dx²-y²" },
          { name: "3dz²", radius: ORBITAL_RADIUS["3d"], type: "dz²" },
        ].forEach(({ name, radius, type }) => {
          const count = element.orbitals[name] || 0;
          if (count > 0) {
            for (let i = 0; i < count; i++) {
              const pos = getDElectronPosition(radius, type, i, count, time);

              ctx.fillStyle = COLORS.electron;
              ctx.globalAlpha = 0.95;
              ctx.shadowBlur = 20;
              ctx.shadowColor = COLORS.d;

              ctx.beginPath();
              ctx.arc(pos.x, pos.y, 6, 0, Math.PI * 2);
              ctx.fill();

              ctx.strokeStyle = pos.spin > 0 ? "#10b981" : "#f59e0b";
              ctx.lineWidth = 2;
              ctx.globalAlpha = 0.9;
              ctx.beginPath();
              ctx.moveTo(pos.x - 4, pos.y - 4);
              ctx.lineTo(pos.x + 4, pos.y - 4);
              if (pos.spin > 0) {
                ctx.lineTo(pos.x + 2, pos.y - 6);
              } else {
                ctx.lineTo(pos.x - 2, pos.y - 6);
              }
              ctx.stroke();
            }
          }
        });

        ctx.shadowBlur = 0;
        ctx.restore();
      }

      function renderNucleus() {
        const element = ELEMENTS[currentElementIndex];
        const protons = element.atomicNumber;
        const totalNucleons = protons + currentNeutrons;
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;

        ctx.save();

        const nucleusRadius = 18 + Math.sqrt(totalNucleons) * 2.5;
        const gradient = ctx.createRadialGradient(
          centerX,
          centerY,
          0,
          centerX,
          centerY,
          nucleusRadius
        );
        gradient.addColorStop(0, "rgba(239, 68, 68, 0.8)");
        gradient.addColorStop(1, "rgba(239, 68, 68, 0.2)");

        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.arc(centerX, centerY, nucleusRadius, 0, Math.PI * 2);
        ctx.fill();

        const nucleonRadius = 3;
        let index = 0;

        for (let i = 0; i < protons; i++) {
          const angle = (index * 2 * Math.PI) / Math.max(totalNucleons, 1);
          const radius = Math.min(12, Math.sqrt(totalNucleons) * 2);
          const x = centerX + Math.cos(angle) * radius;
          const y = centerY + Math.sin(angle) * radius;

          ctx.fillStyle = COLORS.proton;
          ctx.beginPath();
          ctx.arc(x, y, nucleonRadius, 0, Math.PI * 2);
          ctx.fill();
          index++;
        }

        for (let i = 0; i < currentNeutrons; i++) {
          const angle = (index * 2 * Math.PI) / Math.max(totalNucleons, 1);
          const radius = Math.min(12, Math.sqrt(totalNucleons) * 2);
          const x = centerX + Math.cos(angle) * radius;
          const y = centerY + Math.sin(angle) * radius;

          ctx.fillStyle = COLORS.neutron;
          ctx.beginPath();
          ctx.arc(x, y, nucleonRadius, 0, Math.PI * 2);
          ctx.fill();
          index++;
        }

        ctx.restore();
      }

      function render() {
        const element = ELEMENTS[currentElementIndex];

        ctx.fillStyle = "rgba(10, 14, 39, 0.95)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        if (element.orbitals["1s"] > 0)
          renderSOrbital(ORBITAL_RADIUS["1s"], COLORS.s);
        if (element.orbitals["2s"] > 0)
          renderSOrbital(ORBITAL_RADIUS["2s"], COLORS.s);
        if (element.orbitals["3s"] > 0)
          renderSOrbital(ORBITAL_RADIUS["3s"], COLORS.s);
        if (element.orbitals["4s"] > 0)
          renderSOrbital(ORBITAL_RADIUS["4s"], COLORS.s);

        if (
          element.orbitals["2px"] > 0 ||
          element.orbitals["2py"] > 0 ||
          element.orbitals["2pz"] > 0
        ) {
          if (element.orbitals["2px"] > 0)
            renderPOrbital(ORBITAL_RADIUS["2p"], "x", COLORS.p);
          if (element.orbitals["2py"] > 0)
            renderPOrbital(ORBITAL_RADIUS["2p"], "y", COLORS.p);
          if (element.orbitals["2pz"] > 0)
            renderPOrbital(ORBITAL_RADIUS["2p"], "z", COLORS.p);
        }

        if (
          element.orbitals["3px"] > 0 ||
          element.orbitals["3py"] > 0 ||
          element.orbitals["3pz"] > 0
        ) {
          if (element.orbitals["3px"] > 0)
            renderPOrbital(ORBITAL_RADIUS["3p"], "x", COLORS.p);
          if (element.orbitals["3py"] > 0)
            renderPOrbital(ORBITAL_RADIUS["3p"], "y", COLORS.p);
          if (element.orbitals["3pz"] > 0)
            renderPOrbital(ORBITAL_RADIUS["3p"], "z", COLORS.p);
        }

        if (element.orbitals["3dxy"] > 0)
          renderDOrbital(ORBITAL_RADIUS["3d"], "dxy", COLORS.d);
        if (element.orbitals["3dxz"] > 0)
          renderDOrbital(ORBITAL_RADIUS["3d"], "dxz", COLORS.d);
        if (element.orbitals["3dyz"] > 0)
          renderDOrbital(ORBITAL_RADIUS["3d"], "dyz", COLORS.d);
        if (element.orbitals["3dx²-y²"] > 0)
          renderDOrbital(ORBITAL_RADIUS["3d"], "dx²-y²", COLORS.d);
        if (element.orbitals["3dz²"] > 0)
          renderDOrbital(ORBITAL_RADIUS["3d"], "dz²", COLORS.d);

        renderElectrons();
        renderNucleus();
      }

      function animate() {
        time += 0.016;
        render();
        animationFrame = requestAnimationFrame(animate);
      }

      window.addEventListener("load", init);
    </script>
  </body>
</html>
